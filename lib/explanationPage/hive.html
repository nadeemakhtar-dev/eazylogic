<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Flutter Hive Note App Explanation</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    pre {
      background-color: #f8f9fa;
      padding: 10px;
      border: 1px solid #ced4da;
      border-radius: 5px;
      font-size: 0.9rem;
      white-space: pre-wrap;
    }
    code {
      color: #d63384;
      font-weight: bold;
    }
  </style>
</head>
<body>

<div class="container my-5">
  <h1 class="text-center mb-4">Flutter Hive Note App Explanation</h1>

  <section>
    <h2>1. Imports</h2>
    <p>These are the necessary imports for Flutter and Hive:</p>
    <pre><code>import 'package:flutter/material.dart';
import 'package:hive/hive.dart';
import 'package:hive_flutter/hive_flutter.dart';
import 'package:hivedb/main.dart';
import 'package:hivedb/models/note.dart';</code></pre>

    <p><strong>Explanation:</strong></p>
    <ul>
      <li><code>flutter/material.dart</code>: Provides Material Design widgets for the app.</li>
      <li><code>hive</code> and <code>hive_flutter</code>: Used for local data storage with Hive, a lightweight NoSQL database.</li>
      <li><code>main.dart</code> and <code>models/note.dart</code>: Project-specific files for the main structure and data model (Note).</li>
    </ul>
  </section>

  <section>
    <h2>2. NoteApp Class</h2>
    <p>This is the stateful widget responsible for managing the app's note-taking functionality.</p>
    <pre><code>class NoteApp extends StatefulWidget {
  const NoteApp({super.key, required this.title});
  final String title;
  @override
  State<NoteApp> createState() => _NoteAppState();
}</code></pre>

    <p><strong>Explanation:</strong> <code>NoteApp</code> is a <code>StatefulWidget</code> that has a <code>title</code> parameter to display in the app bar. It manages the state for adding, updating, and deleting notes.</p>
  </section>

  <section>
    <h2>3. _NoteAppState Class</h2>
    <p>This class handles all the logic for the NoteApp widget, such as interacting with the Hive database and updating the UI.</p>
    <pre><code>class _NoteAppState extends State&lt;NoteApp&gt; {
  final _noteBox = Hive.box&lt;Note&gt;('notesBox');
  final _nameController = TextEditingController();
  final _descriptionController = TextEditingController();
}</code></pre>

    <p><strong>Explanation:</strong></p>
    <ul>
      <li><code>_noteBox</code>: Opens a Hive box called <code>notesBox</code> where notes are stored.</li>
      <li><code>_nameController</code> and <code>_descriptionController</code>: Manage the input fields for note name and description.</li>
    </ul>
  </section>

  <section>
    <h2>4. Methods</h2>

    <h4><code>_addNote()</code></h4>
    <p>Adds a new note to the Hive database.</p>
    <pre><code>void _addNote() {
  final newNote = Note(
      name: _nameController.text,
      description: _descriptionController.text,
      date: DateTime.now());

  _noteBox.add(newNote);
  _nameController.clear();
  _descriptionController.clear();
  setState(() {});
}</code></pre>

    <h4><code>_deleteNote()</code></h4>
    <p>Deletes a note from Hive.</p>
    <pre><code>void _deleteNote(int index) {
  _noteBox.deleteAt(index);
  setState(() {});
}</code></pre>

    <h4><code>_updateNote()</code></h4>
    <p>Opens a dialog for updating a note. The original data is pre-filled in the input fields.</p>
    <pre><code>void _updateNote(int index, Note note) {
  _nameController.text = note.name;
  _descriptionController.text = note.description;

  showDialog(
    context: context,
    builder: (context) {
      return AlertDialog(
        title: Text('Update Note'),
        content: Column(
          mainAxisSize: MainAxisSize.min,
          children: [
            TextField(
              controller: _nameController,
              decoration: InputDecoration(labelText: 'Note Name'),
            ),
            TextField(
              controller: _descriptionController,
              decoration: InputDecoration(labelText: 'Note Description'),
              maxLines: 10,
            ),
          ],
        ),
        actions: [
          ElevatedButton(
            onPressed: () {
              _noteBox.putAt(index, Note(
                name: _nameController.text,
                description: _descriptionController.text,
                date: note.date,
              ));
              _nameController.clear();
              _descriptionController.clear();
              Navigator.of(context).pop();
              setState(() {});
            },
            child: Text('Update'),
          ),
          ElevatedButton(
            onPressed: () {
              _nameController.clear();
              _descriptionController.clear();
              Navigator.of(context).pop();
            },
            child: Text('Cancel'),
          ),
        ],
      );
    },
  );
}</code></pre>
  </section>

  <section>
    <h2>5. build() Method</h2>
    <p>This method builds the main user interface of the app.</p>
    <pre><code>@override
Widget build(BuildContext context) {
  return Scaffold(
    appBar: AppBar(
      backgroundColor: Theme.of(context).colorScheme.inversePrimary,
      title: Text(widget.title),
    ),
    body: Column(
      children: [
        Padding(
          padding: const EdgeInsets.all(8.0),
          child: Column(
            children: [
              TextField(
                controller: _nameController,
                decoration: InputDecoration(labelText: 'Note Name'),
              ),
              TextField(
                controller: _descriptionController,
                decoration: InputDecoration(labelText: 'Enter description'),
              ),
              SizedBox(height: 20),
            ],
          ),
        ),
        Expanded(
          child: ValueListenableBuilder(
            valueListenable: _noteBox.listenable(),
            builder: (context, Box&lt;Note&gt; box, _) {
              if (box.values.isEmpty) {
                return Center(child: Text('No Notes Found'));
              }
              return ListView.builder(
                itemCount: box.values.length,
                itemBuilder: (context, index) {
                  Note? note = box.getAt(index);
                  return Dismissible(
                    key: Key(note!.name),
                    direction: DismissDirection.horizontal,
                    confirmDismiss: (direction) async {
                      if (direction == DismissDirection.startToEnd) {
                        _updateNote(index, note);
                        return false;
                      } else if (direction == DismissDirection.endToStart) {
                        _deleteNote(index);
                        return true;
                      }
                      return false;
                    },
                    child: Card(
                      child: ListTile(
                        title: Text(note?.name ?? ""),
                        subtitle: Text(
                          (note?.description ?? "").split('\\n').first,
                          maxLines: 1,
                          overflow: TextOverflow.ellipsis,
                        ),
                        trailing: Text(note?.date.toLocal().toString() ?? ''),
                      ),
                    ),
                  );
                },
              );
            },
          ),
        ),
      ],
    ),
    floatingActionButton: FloatingActionButton.extended(
      isExtended: true,
      label: Text('Add Note'),
      icon: Icon(Icons.add_business),
      onPressed: _addNote,
    ),
  );
}</code></pre>

    <p><strong>Explanation:</strong></p>
    <ul>
      <li><code>ValueListenableBuilder</code>: Listens for changes in the Hive box and updates the UI.</li>
      <li><code>ListView.builder</code>: Dynamically builds a scrollable list of notes.</li>
      <li><code>Dismissible</code>: Enables swiping to update or delete notes.</li>
      <li><code>FloatingActionButton.extended</code>: A floating button to add new notes.</li>
    </ul>
  </section>

</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
